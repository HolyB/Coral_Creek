# è‚¡ç¥¨æ‰«æç³»ç»Ÿ - Crontab å®šæ—¶ä»»åŠ¡é…ç½®æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å¸®åŠ©æ‚¨åœ¨æ”¯æŒcronçš„ç¯å¢ƒä¸­è®¾ç½®è‡ªåŠ¨åŒ–çš„è‚¡ç¥¨æ‰«æå®šæ—¶ä»»åŠ¡ï¼ŒåŸºäºåŒ—äº¬æ—¶é—´æ‰§è¡Œã€‚

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

æ‚¨éœ€è¦åœ¨ä»¥ä¸‹ç¯å¢ƒä¹‹ä¸€ä¸­è¿è¡Œï¼š

### é€‰é¡¹1: WSL (Windows Subsystem for Linux) - **æ¨è**
```bash
# å®‰è£…WSL (PowerShellç®¡ç†å‘˜æ¨¡å¼)
wsl --install

# å¯åŠ¨WSLåï¼Œå®‰è£…cron
sudo apt update
sudo apt install cron

# å¯åŠ¨cronæœåŠ¡
sudo service cron start
```

### é€‰é¡¹2: Git Bash + Cygwin
```bash
# ä¸‹è½½å¹¶å®‰è£… Cygwin
# åœ¨å®‰è£…æ—¶é€‰æ‹©åŒ…å« cron åŒ…
```

### é€‰é¡¹3: åŸç”ŸLinux/MacOS
```bash
# å¤§å¤šæ•°Linuxå‘è¡Œç‰ˆé»˜è®¤åŒ…å«cron
# MacOSä½¿ç”¨launchdï¼Œä½†ä¹Ÿæ”¯æŒcrontabå‘½ä»¤
```

## ğŸš€ å¿«é€Ÿå®‰è£…

### æ–¹æ³•1: è‡ªåŠ¨å®‰è£…è„šæœ¬ (æ¨è)

åœ¨æ”¯æŒbashçš„ç»ˆç«¯ä¸­è¿è¡Œï¼š

```bash
# è¿›å…¥Coral_Creekç›®å½•
cd /d/Cursor/Coral_Creek

# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x install_crontab.sh

# è¿è¡Œå®‰è£…è„šæœ¬
bash install_crontab.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨å®‰è£…

```bash
# 1. è¿›å…¥ç›®å½•
cd /d/Cursor/Coral_Creek

# 2. å¤‡ä»½ç°æœ‰crontab (å¦‚æœæœ‰)
crontab -l > crontab_backup.txt

# 3. å®‰è£…æ–°çš„crontabä»»åŠ¡
crontab stock_scanner_crontab.txt

# 4. éªŒè¯å®‰è£…
crontab -l
```

## ğŸ“… å®šæ—¶ä»»åŠ¡å®‰æ’ (åŒ—äº¬æ—¶é—´)

### ğŸ¢ å·¥ä½œæ—¥ Aè‚¡æ‰«æ
| æ—¶é—´  | ä»»åŠ¡åç§° | è¯´æ˜ |
|-------|----------|------|
| 08:30 | ç›˜å‰æ—©æœŸæ‰«æ | è·å–éš”å¤œæ¶ˆæ¯ï¼Œå°æ‰¹é‡å¤„ç† |
| 09:00 | ç›˜å‰æ‰«æ | å¼€ç›˜å‰æœ€åæ‰«æï¼Œä¸­ç­‰æ‰¹é‡ |
| 09:15 | **Aè‚¡BLUEä¿¡å·æ‰«æ** | å¼€ç›˜å‰BLUEä¿¡å·æ£€æµ‹ |
| 10:30 | ä¸Šåˆç›˜ä¸­æ‰«æ | ä¸Šåˆäº¤æ˜“æ—¶æ®µï¼Œå¤§æ‰¹é‡å¤„ç† |
| 14:00 | ä¸‹åˆç›˜ä¸­æ‰«æ | ä¸‹åˆå¼€ç›˜åï¼Œå¤§æ‰¹é‡å¤„ç† |
| 15:30 | ç›˜åæ‰«æ | æ”¶ç›˜åç«‹å³æ‰«æ |
| 15:45 | **Aè‚¡BLUEç›˜åæ‰«æ** | æ”¶ç›˜åBLUEä¿¡å·æ·±åº¦æ£€æµ‹ |
| 16:30 | ç›˜åæ·±åº¦æ‰«æ | æ·±åº¦åˆ†æ |

### ğŸŒ å·¥ä½œæ—¥ æ¸¯è‚¡æ‰«æ
| æ—¶é—´  | ä»»åŠ¡åç§° | è¯´æ˜ |
|-------|----------|------|
| 09:15 | æ¸¯è‚¡ç›˜å‰æ‰«æ | æ¸¯è‚¡å¼€ç›˜å‰ |
| 11:00 | æ¸¯è‚¡ç›˜ä¸­æ‰«æ | æ¸¯è‚¡ä¸Šåˆäº¤æ˜“æ—¶æ®µ |
| 14:30 | æ¸¯è‚¡ä¸‹åˆæ‰«æ | æ¸¯è‚¡ä¸‹åˆäº¤æ˜“æ—¶æ®µ |
| 16:30 | æ¸¯è‚¡ç›˜åæ‰«æ | æ¸¯è‚¡æ”¶ç›˜å |

### ğŸ‡ºğŸ‡¸ å·¥ä½œæ—¥ ç¾è‚¡æ‰«æ (åŒ—äº¬æ—¶é—´)
| æ—¶é—´  | ä»»åŠ¡åç§° | è¯´æ˜ |
|-------|----------|------|
| 21:00 | ç¾è‚¡ç›˜å‰æ‰«æ | ç¾è‚¡å¼€ç›˜å‰å‡†å¤‡ |
| 22:30 | ç¾è‚¡å¼€ç›˜æ‰«æ | ç¾è‚¡å¼€ç›˜æ—¶æ®µ |
| 01:30+1 | ç¾è‚¡ç›˜ä¸­æ‰«æ | ç¾è‚¡äº¤æ˜“ä¸­æœŸ |
| 05:30+1 | ç¾è‚¡ç›˜åæ‰«æ | ç¾è‚¡æ”¶ç›˜ååˆ†æ |

### ğŸ”µ BLUEä¿¡å·ä¸“é¡¹æ‰«æ
| æ—¶é—´  | ä»»åŠ¡åç§° | è¯´æ˜ |
|-------|----------|------|
| 09:15 (å·¥ä½œæ—¥) | Aè‚¡BLUEä¿¡å·æ‰«æ | å¼€ç›˜å‰BLUEä¿¡å·æ£€æµ‹ |
| 15:45 (å·¥ä½œæ—¥) | Aè‚¡BLUEç›˜åæ‰«æ | æ”¶ç›˜åBLUEä¿¡å·æ·±åº¦æ£€æµ‹ |
| å‘¨å…­ 14:00 | å‘¨æœ«BLUEæ·±åº¦æ‰«æ | å…¨å¸‚åœºBLUEä¿¡å·åˆ†æ |

### ğŸ–ï¸ å‘¨æœ«æ‰«æ
| æ—¶é—´ | ä»»åŠ¡åç§° | è¯´æ˜ |
|------|----------|------|
| å‘¨å…­ 10:00 | Aè‚¡ç»¼åˆæ‰«æ | å‘¨æœ«æ·±åº¦åˆ†æ |
| å‘¨å…­ 10:30 | æ¸¯è‚¡æ‰«æ | æ¸¯è‚¡å‘¨æœ«åˆ†æ |
| å‘¨å…­ 14:00 | **å‘¨æœ«BLUEæ·±åº¦æ‰«æ** | å…¨å¸‚åœºBLUEä¿¡å·åˆ†æ |
| å‘¨æ—¥ 20:00 | å‡†å¤‡æ‰«æ | ä¸ºä¸‹å‘¨åšå‡†å¤‡ |

## ğŸ”§ ç®¡ç†å‘½ä»¤

### æŸ¥çœ‹å’Œç®¡ç†
```bash
# æŸ¥çœ‹å½“å‰æ‰€æœ‰å®šæ—¶ä»»åŠ¡
crontab -l

# ç¼–è¾‘å®šæ—¶ä»»åŠ¡
crontab -e

# åˆ é™¤æ‰€æœ‰å®šæ—¶ä»»åŠ¡
crontab -r

# æŸ¥çœ‹cronæœåŠ¡çŠ¶æ€ (Linux)
sudo service cron status

# é‡å¯cronæœåŠ¡
sudo service cron restart
```

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹cronæ—¥å¿— (Linux)
sudo tail -f /var/log/cron

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
sudo tail -f /var/log/syslog | grep CRON

# æŸ¥çœ‹ç‰¹å®šä»»åŠ¡æ—¥å¿—
grep "è‚¡ç¥¨æ‰«æ" /var/log/syslog
```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**1. crontabå‘½ä»¤ä¸å­˜åœ¨**
```bash
# Ubuntu/Debian
sudo apt install cron

# CentOS/RHEL
sudo yum install cronie
```

**2. ä»»åŠ¡ä¸æ‰§è¡Œ**
```bash
# æ£€æŸ¥cronæœåŠ¡æ˜¯å¦è¿è¡Œ
sudo service cron status

# å¯åŠ¨cronæœåŠ¡
sudo service cron start

# æ£€æŸ¥PATHç¯å¢ƒå˜é‡
which python
```

**3. Pythonè„šæœ¬æ‰¾ä¸åˆ°**
```bash
# æ£€æŸ¥è„šæœ¬è·¯å¾„
ls -la /d/Cursor/Coral_Creek/scan_*.py

# æ£€æŸ¥æ‰§è¡Œæƒé™
chmod +x *.py
```

**4. æ—¶åŒºé—®é¢˜**
```bash
# æ£€æŸ¥ç³»ç»Ÿæ—¶åŒº
date
timedatectl status

# è®¾ç½®æ—¶åŒºä¸ºåŒ—äº¬æ—¶é—´
sudo timedatectl set-timezone Asia/Shanghai
```

### è°ƒè¯•æ–¹æ³•

**1. æ‰‹åŠ¨æµ‹è¯•è„šæœ¬**
```bash
cd /d/Cursor/Coral_Creek
python scan_cn_signals_multi_thread_tushare.py --batch_size 10 --timing "æµ‹è¯•"
```

**2. æ·»åŠ æ—¥å¿—è¾“å‡º**
åœ¨crontabä»»åŠ¡åæ·»åŠ æ—¥å¿—é‡å®šå‘ï¼š
```bash
30 8 * * 1-5 cd /d/Cursor/Coral_Creek && python scan_cn_signals_multi_thread_tushare.py --timing "ç›˜å‰" >> cron_output.log 2>&1
```

**3. æ£€æŸ¥ç¯å¢ƒå˜é‡**
åœ¨crontabä¸­æ·»åŠ ï¼š
```bash
* * * * * env > /tmp/cron_env.txt
```

## ğŸ“ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æ‰«æå‚æ•°
ç¼–è¾‘ `stock_scanner_crontab.txt` æ–‡ä»¶ä¸­çš„å‚æ•°ï¼š

```bash
# ä¿®æ”¹æ‰¹é‡å¤§å°
--batch_size 500

# ä¿®æ”¹çº¿ç¨‹æ•°
--max_workers 10

# ä¿®æ”¹ä¿¡å·ç±»å‹
--signal_type both  # both/bullish/bearish

# ä¿®æ”¹æœ€å°æˆäº¤é‡
--min_turnover 200
```

### æ·»åŠ æ–°çš„æ‰«ææ—¶é—´
```bash
# ä¾‹å¦‚ï¼šæ·»åŠ ä¸­åˆ12:00çš„æ‰«æ
0 12 * * 1-5 cd /d/Cursor/Coral_Creek && python scan_cn_signals_multi_thread_tushare.py --timing "ä¸­åˆæ‰«æ"
```

## ğŸ” å®‰å…¨å»ºè®®

1. **é™åˆ¶æ–‡ä»¶æƒé™**
```bash
chmod 600 stock_scanner_crontab.txt
```

2. **ä½¿ç”¨ä¸“ç”¨ç”¨æˆ·**
```bash
# åˆ›å»ºä¸“ç”¨ç”¨æˆ·
sudo useradd -m stockscan
sudo su - stockscan
```

3. **ç›‘æ§æ—¥å¿—**
```bash
# å®šæœŸæ£€æŸ¥æ—¥å¿—æ–‡ä»¶å¤§å°
find . -name "*.log" -size +100M
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### è‡ªåŠ¨ç»´æŠ¤ä»»åŠ¡
```bash
# æ·»åŠ åˆ°crontabï¼šæ¯å‘¨æ¸…ç†æ—§æ—¥å¿—
0 2 * * 0 find /d/Cursor/Coral_Creek -name "*.log" -mtime +7 -delete

# æ¯æœˆç”ŸæˆæŠ¥å‘Š
0 0 1 * * cd /d/Cursor/Coral_Creek && echo "$(date) - æœˆåº¦æŠ¥å‘Š" >> monthly_report.log
```

### æ€§èƒ½ç›‘æ§
```bash
# æ£€æŸ¥CPUå’Œå†…å­˜ä½¿ç”¨
top -p $(pgrep -f python)

# æ£€æŸ¥ç£ç›˜ç©ºé—´
df -h
```

---

## ğŸ“ æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. ç³»ç»Ÿæ—¶é—´å’Œæ—¶åŒºè®¾ç½®
2. Pythonå’Œä¾èµ–åŒ…å®‰è£…
3. æ–‡ä»¶è·¯å¾„å’Œæƒé™
4. CronæœåŠ¡çŠ¶æ€

## ğŸ†• æ–°å¢æ‰«æåŠŸèƒ½

### ğŸ“Š æ”¯æŒçš„å¸‚åœº
ç°åœ¨ç³»ç»Ÿæ”¯æŒå®Œæ•´çš„å…¨çƒè‚¡ç¥¨å¸‚åœºæ‰«æï¼š

| å¸‚åœº | è„šæœ¬ | è¯´æ˜ |
|------|------|------|
| ğŸ‡¨ğŸ‡³ Aè‚¡ | `scan_cn_signals_multi_thread_tushare.py` | ä¼ ç»ŸæŠ€æœ¯æŒ‡æ ‡æ‰«æ |
| ğŸ‡­ğŸ‡° æ¸¯è‚¡ | `scan_hk_signals_multi_thread_tushare.py` | æ¸¯è‚¡å¸‚åœºæ‰«æ |
| ğŸ‡ºğŸ‡¸ ç¾è‚¡ | `scan_us_stocks_combined.py` | ç¾è‚¡å¸‚åœºæ‰«æ |
| ğŸ”µ BLUEä¿¡å· | `scan_blue_signals_simple.py` | ä¸“é—¨çš„BLUEä¿¡å·æ£€æµ‹ |

### ğŸ”µ BLUEä¿¡å·æ‰«æç‰¹è‰²
- **ä¸“é¡¹æ£€æµ‹**ï¼šåªå…³æ³¨BLUEæŠ€æœ¯æŒ‡æ ‡ä¿¡å·
- **é«˜æ•ˆç¨³å®š**ï¼šç®€åŒ–ç‰ˆå®ç°ï¼Œè¿è¡Œæ›´ç¨³å®š
- **çµæ´»é…ç½®**ï¼šæ”¯æŒå¤šç§å‚æ•°è‡ªå®šä¹‰
- **è¯¦ç»†è¾“å‡º**ï¼šæä¾›ä¸°å¯Œçš„åˆ†æç»“æœ

### ğŸŒ ç¾è‚¡äº¤æ˜“æ—¶é—´è¯´æ˜
ç¾è‚¡äº¤æ˜“æ—¶é—´ï¼ˆæŒ‰åŒ—äº¬æ—¶é—´ï¼‰ï¼š
- **å¤ä»¤æ—¶**ï¼š21:30 - 04:00+1
- **å†¬ä»¤æ—¶**ï¼š22:30 - 05:00+1

ç³»ç»Ÿè‡ªåŠ¨æŒ‰ç…§è¿™äº›æ—¶é—´å®‰æ’ç¾è‚¡æ‰«æä»»åŠ¡ã€‚

### ğŸš€ æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤

**æµ‹è¯•Aè‚¡BLUEä¿¡å·æ‰«æï¼š**
```bash
cd /d/Cursor/Coral_Creek
python scan_blue_signals_simple.py --batch_size 50 --timing "æ‰‹åŠ¨æµ‹è¯•"
```

**æµ‹è¯•ç¾è‚¡æ‰«æï¼š**
```bash
cd /d/Cursor/Coral_Creek
python scan_us_stocks_combined.py --batch_size 100 --timing "æ‰‹åŠ¨æµ‹è¯•"
```

**æµ‹è¯•æ‰€æœ‰æ‰«æï¼ˆä¾æ¬¡æ‰§è¡Œï¼‰ï¼š**
```bash
cd /d/Cursor/Coral_Creek
python scan_cn_signals_multi_thread_tushare.py --batch_size 50 --timing "æµ‹è¯•" && \
python scan_hk_signals_multi_thread_tushare.py --batch_size 50 --timing "æµ‹è¯•" && \
python scan_us_stocks_combined.py --batch_size 50 --timing "æµ‹è¯•" && \
python scan_blue_signals_simple.py --batch_size 50 --timing "æµ‹è¯•"
```

---

**è®°ä½ï¼šæ‰€æœ‰æ—¶é—´éƒ½åŸºäºåŒ—äº¬æ—¶é—´ (Asia/Shanghai)** 
# Coral Creek V1 - 项目状态与未来规划

## 📅 当前版本 (V1) 完成情况
**版本目标**：建立一个基于信号扫描（BLUE趋势+黑马反转）的股票监控与分析系统。

### 1. 核心扫描引擎
- [x] **美股扫描器 (`scan_us_signals.py`)**:
    - 数据源切换至 Polygon API，解决 yfinance 限制。
    - 实现多线程并发扫描，大幅提升速度。
    - 策略逻辑：日线/周线 BLUE 趋势信号 + 黑马/掘底反转信号。
    - 记录信号出现的具体日期序列。
- [x] **A股扫描器 (`scan_cn_signals_blue_only.py`)**:
    - 数据源使用 Tushare API。
    - 保持与美股相同的信号逻辑配置。
    - 支持分批次扫描和断点续传。

### 2. 数据存储与管理
- [x] **SQLite 数据库**: 统一存储美股和A股的扫描结果。
- [x] **JSON 数据结构**: 存储复杂的信号日期列表和对应数值。
- [x] **配置管理**: 使用 `config.json` 统一管理 API Key 和邮件配置。

### 3. 前端可视化 (Streamlit App)
- [x] **信号监控看板**:
    - 支持按市场、价格、成交额、信号类型（日/周）、信号强度进行高级筛选。
    - 显示详细的信号日期列表。
- [x] **交互式图表**:
    - 集成 Plotly K线图。
    - **独家功能**: 在K线图上叠加 BLUE 信号趋势线和信号点标注。
    - **筹码分布 (Volume Profile)**: 支持动态调整时间范围的筹码分布图，辅助判断支撑压力。
- [x] **自选股系统**:
    - 独立的“自选股看板”，无论是否有信号均可查看行情。
    - 在扫描列表中快速添加/移除自选。
- [x] **统计分析**:
    - 历史数据对比（查看新增/消失信号）。
    - 信号分布统计和市场概况。

### 4. 通知系统
- [x] **邮件通知**:
    - 扫描结束后自动发送 HTML 格式报告。
    - **智能高亮**: 优先展示自选股中的信号命中情况。
    - 包含详细的 BLUE 和 黑马信号列表。

---

## 🚀 迈向完整量化系统的差距 (Gap Analysis)
目前 V1 作为一个**监控/扫描系统 (Scanner/Monitor)** 已经非常完善，但距离一个**完整的量化交易系统 (Quantitative Trading System)** 还有以下不足：

### 1. 回测系统 (Backtesting Engine) - **核心缺失**
- **现状**: 目前只能看到“过去发出了信号”，无法验证策略的历史盈利能力。
- **需求**:
    - 需要一个事件驱动的回测引擎 (如 integration with `backtrader` or custom engine)。
    - 计算策略指标：年化收益率、最大回撤 (Max Drawdown)、夏普比率 (Sharpe Ratio)、胜率、盈亏比。
    - 资金管理回测：仓位控制对收益的影响。

### 2. 实盘/模拟交易执行 (Execution System)
- **现状**: 仅提供信号，需人工下单。
- **需求**:
    - 对接券商 API (如 Interactive Brokers, 富途牛牛, 老虎证券)。
    - 实现自动下单 (Order Placement)。
    - 订单状态管理 (Filled, Cancelled, Rejected)。
    - 风控模块：自动止损、止盈、最大持仓限制。

### 3. 实时性与数据增强 (Real-time Data)
- **现状**: 基于日线/周线数据，属于盘后或低频分析。
- **需求**:
    - 引入分钟级数据 (Intraday Data) 用于更精准的择时。
    - 实时 WebSocket 数据流，实现盘中即时预警（而非跑批处理）。

### 4. 策略开发平台 (Strategy Factory)
- **现状**: 策略逻辑硬编码在扫描脚本中。
- **需求**:
    - 策略解耦：将 `BLUE`、`Heima` 封装为独立的策略类。
    - 支持用户通过配置文件或简单的 Python 脚本添加新指标/新策略，无需修改核心扫描代码。

### 5. 系统架构升级
- **现状**: 单机脚本 + 本地 SQLite 文件。
- **需求**:
    - 数据库迁移至 PostgreSQL 或 TimescaleDB 以处理海量历史数据。
    - 任务调度系统 (如 Airflow 或 Celery) 替代简单的 Batch 脚本。
    - 前后端分离 (如 FastAPI + React/Vue) 以支持多用户和更复杂的交互（如果需要商业化）。

## 📝 下一步行动建议 (Next Steps)
1. **短期 (V1.5)**: 
   - 优化 UI 主题为深色模式。
   - 移动端适配。
   - 增加更多技术指标叠加（如 Bollinger Bands, MACD）。
2. **中期 (V2.0)**: 
   - **开发简易回测模块**：选取一只股票，计算在过去 3 年仅按 BLUE 信号操作的模拟收益曲线。
3. **长期 (V3.0)**: 
   - 对接 IBKR 或 富途 模拟盘 API，实现“看信号 -> 自动下模拟单”的闭环。

